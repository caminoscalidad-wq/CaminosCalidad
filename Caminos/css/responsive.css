/* --- RESPONSIVE MOBILE - MEJORADO --- */
@media (max-width: 768px) {
    :root {
        --sidebar-width: 100%;
        --mobile-sidebar-height: 85vh;
    }

    body {
        background: white;
        touch-action: pan-x pan-y; /* Mejora interacción táctil */
    }

    #sidebar-toggle {
        display: flex;
        bottom: 20px;
        right: 20px;
        z-index: 3000;
    }

    #sidebar {
        position: fixed;
        top: auto;
        bottom: 0;
        left: 0;
        width: 100%;
        height: var(--mobile-sidebar-height);
        max-height: 100%;
        transform: translateY(100%);
        box-shadow: 0 -8px 32px rgba(0,0,0,0.2);
        border-right: none;
        border-top: 1px solid rgba(0,0,0,0.08);
        border-radius: 20px 20px 0 0;
        overflow: hidden;
        transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    #sidebar.active {
        transform: translateY(0);
    }

    .sidebar-header {
        border-radius: 20px 20px 0 0;
        padding: 25px 20px 20px;
    }

    .close-sidebar-btn {
        display: flex;
    }

    #sidebar.active ~ #sidebar-toggle {
        display: none;
    }

    .section-card {
        padding: 15px;
        margin-bottom: 15px;
    }

    input[type="text"] {
        padding: 16px 16px 16px 48px;
        font-size: 16px; /* Evita zoom en iOS */
    }

    button {
        padding: 14px;
        min-height: 44px; /* Tamaño mínimo para toque */
    }

    /* MEJORA: Mostrar instrucciones en móvil dentro del sidebar */
    #floating-directions {
        display: none !important;
    }

    #mobile-instructions {
        display: block;
    }

    .btn-instr-sidebar {
        display: block !important;
        margin-top: 15px;
    }

    /* MEJORA: Resultados de búsqueda en móvil */
    .search-results {
        position: fixed;
        top: auto !important;
        bottom: 0;
        left: 0;
        right: 0;
        max-height: 50vh;
        border-radius: 0;
        transform: translateY(100%);
        transition: transform 0.3s ease;
        z-index: 3001;
        border: none;
        box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
    }

    .search-results.active {
        transform: translateY(0);
    }

    /* Ajustar cuando sidebar está abierto */
    #sidebar.active ~ .search-results.active {
        bottom: var(--mobile-sidebar-height);
        transform: translateY(0);
    }

    .custom-controls-container {
        top: 5px;
        left: 5px;
    }

    .custom-control-btn {
        width: 36px;
        height: 36px;
        font-size: 1rem;
    }

    #gps-status {
        bottom: 80px;
        font-size: 0.75rem;
        padding: 6px 12px;
    }

    /* Mejorar scroll en móvil */
    .sidebar-content {
        padding-bottom: 30px; /* Espacio para botón de toggle */
    }

    /* Ajustar mapa cuando sidebar está abierto */
    #sidebar.active ~ #map-wrapper #map {
        height: calc(100% - var(--mobile-sidebar-height));
    }
}